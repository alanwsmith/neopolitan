[! include "macros.neoj" !]

&lt;code&gt;
[! for child_span in span.spans !]
[@ child_span.content @]

[#
{attrs: 
[! for attr in span.attrs !]
[@ attr @]> [@ output_spans(span.attrs[attr]) @],
[! endfor !]

, flags: 

[! for flag in span.flags !]
[@ flag @]
[! endfor !]
}
#]

[! endfor !]

[@ output_span_flags(span) @]
[@ output_span_attrs(span) @]

&lt;/code&gt;

